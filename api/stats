import { getStats } from "./stats";

export default async function handler(req, res) {
  const msg = req.body.message;
  if (!msg) return res.end();

  const chatId = msg.chat.id;
  const text = msg.text;

  if (text === "/stats") {
    const s = getStats();

    const reply = `
ðŸ“Š *STATISTIK DOWNLOADER*

ðŸ“¥ Total : ${s.total}
ðŸ“¸ Instagram : ${s.ig}
ðŸŽµ TikTok : ${s.tt}
`;

    await fetch(`https://api.telegram.org/bot${process.env.BOT_TOKEN}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: chatId,
        text: reply,
        parse_mode: "Markdown"
      })
    });
  }

  res.json({ ok: true });
}
