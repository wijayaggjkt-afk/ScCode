<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Instagram & TikTok Downloader - Zidan Dev</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI}
body{
background:linear-gradient(135deg,#667eea,#764ba2);
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
padding:20px
}
.container{
max-width:900px;width:100%;
background:#fff;
border-radius:20px;
padding:30px;
box-shadow:0 15px 30px rgba(0,0,0,.2)
}
header{text-align:center;margin-bottom:25px}
header h1{color:#667eea;font-size:2.4rem}
.subtitle{color:#555}

.input-box{
background:#f8f9fa;
padding:20px;
border-radius:15px
}
input{
width:100%;
padding:14px;
border-radius:10px;
border:2px solid #ddd;
font-size:1rem
}
.platforms{display:flex;gap:10px;margin-top:15px}
.platform{
flex:1;
padding:12px;
border-radius:10px;
border:2px solid #ddd;
cursor:pointer;
font-weight:600;
display:flex;
justify-content:center;
gap:10px
}
.platform.active{background:#667eea;color:#fff;border-color:#667eea}

button{
margin-top:20px;
width:100%;
padding:15px;
font-size:1.1rem;
border:none;
border-radius:10px;
background:linear-gradient(to right,#667eea,#764ba2);
color:#fff;
font-weight:600;
cursor:pointer
}

.loading{text-align:center;display:none;margin-top:20px}
.spinner{
width:45px;height:45px;
border:5px solid #eee;
border-top:5px solid #667eea;
border-radius:50%;
animation:spin 1s linear infinite;
margin:auto
}
@keyframes spin{100%{transform:rotate(360deg)}}

.error{
display:none;
background:#ffebee;
color:#c62828;
padding:15px;
border-radius:10px;
margin-top:20px
}

.result{
display:none;
margin-top:30px;
background:#f8f9fa;
padding:20px;
border-radius:15px
}
.result img{
max-width:100%;
border-radius:10px;
margin-bottom:20px
}
.options{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
gap:15px
}
.option{
background:#fff;
padding:15px;
border-radius:10px;
display:flex;
justify-content:space-between;
align-items:center
}
.option a{
background:#667eea;
color:#fff;
padding:8px 14px;
border-radius:7px;
text-decoration:none
}

footer{
color:#fff;
margin-top:25px;
text-align:center
}
</style>
</head>

<body>

<div class="container">
<header>
<h1><i class="fas fa-download"></i> Downloader By Zidan Dev</h1>
<p class="subtitle">Download Instagram & TikTok tanpa ribet</p>
</header>

<div class="input-box">
<input id="url" placeholder="Masukkan URL Instagram / TikTok">

<div class="platforms">
<div class="platform active" data-p="ig"><i class="fab fa-instagram"></i> Instagram</div>
<div class="platform" data-p="tt"><i class="fab fa-tiktok"></i> TikTok</div>
</div>

<button onclick="download()">Download</button>
</div>

<div class="loading" id="loading">
<div class="spinner"></div>
<p>Mengambil data...</p>
</div>

<div class="error" id="error"></div>

<div class="result" id="result">
<img id="thumb">
<div class="options" id="options"></div>
</div>

</div>

<footer>
© 2023 Downloader By Zidan Dev. Semua hak dilindungi.
</footer>

<script>
let platform = "ig";

document.querySelectorAll(".platform").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".platform").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    platform = btn.dataset.p;
  }
});

async function download(){
  const url = document.getElementById("url").value.trim();
  if(!url) return showError("URL tidak boleh kosong");

  hideError();
  showLoading(true);

  try{
    if(platform === "ig"){
      // ✅ FIX: pakai API Vercel sendiri
      const api = `/api/ig?url=${encodeURIComponent(url)}`;
      const res = await fetch(api);
      const json = await res.json();

      if(!json.status || !json.data || !json.data.length){
        throw "Video tidak ditemukan";
      }

      const v = json.data[0];

      showResult(
        v.thumbnail,
        [
          { label:"Video MP4", url:v.url },
          { label:"Audio MP3", url:v.url + "&dl=audio" }
        ]
      );

    }else{
      throw "TikTok belum diaktifkan";
    }

  }catch(e){
    showError(typeof e === "string" ? e : "Terjadi kesalahan");
  }finally{
    showLoading(false);
  }
}

function showResult(thumb, links){
  document.getElementById("result").style.display="block";
  document.getElementById("thumb").src=thumb;
  const opt=document.getElementById("options");
  opt.innerHTML="";
  links.forEach(l=>{
    opt.innerHTML+=`
    <div class="option">
      <span>${l.label}</span>
      <a href="${l.url}" target="_blank">Download</a>
    </div>`;
  });
}

function showLoading(s){
  document.getElementById("loading").style.display=s?"block":"none";
}
function showError(t){
  const e=document.getElementById("error");
  e.style.display="block";
  e.innerText=t;
}
function hideError(){
  document.getElementById("error").style.display="none";
}
</script>

</body>
  </html>
